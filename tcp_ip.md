## TCP/IP 协议

### TCP 六种标志位

1. SYN -- synchronous 建立连接 
2. ACK -- acknowledgement 确认响应 
3. PSH -- push 有数据传输 
4. FIN -- finish 关闭连接
5. RST -- reset 重置连接
6. URG -- urgent 紧急指针字段值有效

### TCP 序列号与确认号

> 在 TCP 协议中，序列号与确认号是非常重要的标识符，用于确保数据传输的可靠性
1. 序列号：seq -- sequence number
2. 确认号：ack -- acknowledgement number

### TCP 常见连接状态

1. CLOSED（关闭）：初始状态，表示连接未建立或已关闭
2. LISTEN（监听）：表示服务器正在等待客户端的连接请求
3. SYN_SENT（同步已发送）：表示客户端已发送连接请求（SYN 包），等待服务器确认
4. SYN_RECEIVED（同步已接收）：表示服务器已收到连接请求，并发送确认
5. ESTABLISHED（已建立）：表示连接已成功建立，双方或以进行数据传输
6. FIN_WAIT_1（终止等待1）：表示连接的一方（通常是客户端）发送了终止连接请求（FIN 包），等待另一方的确认
7. FIN_WAIT_2（终止等等2）：表示连接的一方已收到另一方的确认，等待另一方发送终止连接请求
8. CLOSE_WAIT（关闭连接）：表示连接的一方收到终止连接请求，并发送确认，但还示发送自己的终止连接请求
9. LAST_ACK（最后确认）：表示连接的一方确认了另一方的终止请求后，发送了终止连接请求，并等待另一方的确认
10. TIME_WAIT（时间等待）：表示连接的一方发送了终止连接请求，并收到另一方的确认，为了确保另一方收到确认后才会进入 Closed 状态，仍保持连接状态一段时间

## TCP 建立连接为什么要三次握手？

> 为了确保连接的可靠性
- 第一次握手，`服务端`可确认：客户端的发送能力是正常的
- 第二次握手，`客户端`可确认：服务端的接收、发送能力是正常的，但此时`服务端`无法确认客户端的接收能力是否正常
- 第三次握手，`服务端`可确认：客户端的接收、发送能力是正常的，至此双方都能确认对方的接收、发送能力是正常的了

## TCP 关闭连接为什么要四次挥手？

> 假设由客户端先发起终止连接请求
- 第一次挥手，表示客户端已经不在发送数据
- 第二次挥手，表示服务端确认了客户端的终止请求
- 第三次挥手，表示服务端也不在发送数据了
- 第四次挥手，表示客户端确认了服务端的终止请求，为了确保服务端能够收到确认，客户端会等待 2MSL 后才会最终关闭连接

## TCP SNY 攻击是什么？

在建立连接时，大量伪造虚假客户端地址，一个是使得半连接队列过大，另一个是服务端会大量重复确认请求，造成服务器资源过度浪费甚至宕机
